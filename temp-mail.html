<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FTX TempMail Pro</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root {
  --primary: #7c3aed;        /* purple */
  --primary-dark: #5b21b6;   /* darker purple */
  --secondary: #3b82f6;
  --bg: #f0f2f5;
  --card-bg: #fff;
  --text: #1f2937;
  --text-muted: #6b7280;
  --border: #e5e7eb;
  --shadow: 0 4px 12px rgba(0,0,0,0.08);
  --shadow-hover: 0 8px 20px rgba(0,0,0,0.12);
}

body { font-family: 'Inter', sans-serif; background-color: var(--bg); margin: 0; color: var(--text); }
header { background: linear-gradient(135deg, var(--primary-dark), var(--primary)); color: #fff; text-align: center; padding: 3rem 1rem; font-size: 2.5rem; font-weight: 800; letter-spacing: -1px; border-bottom-left-radius: 1.5rem; border-bottom-right-radius: 1.5rem; }
.container { max-width: 800px; margin: -2rem auto 2rem auto; padding: 0 1rem; z-index: 10; position: relative; }
.card { background-color: var(--card-bg); padding: 2rem; border-radius: 1rem; box-shadow: var(--shadow); margin-bottom: 2rem; border: 1px solid var(--border); transition: transform 0.2s ease, box-shadow 0.2s ease; }
.card:hover { transform: translateY(-2px); box-shadow: var(--shadow-hover); }
.email-display-wrapper { max-width: 500px; margin: 1rem auto; }
#addr { width: 100%; font-size: 1.2rem; padding: 0.75rem 1rem; border: 2px solid var(--border); border-radius: 0.5rem; background-color: #f9fafb; color: var(--primary-dark); text-align: center; font-weight: 600; transition: all 0.3s ease; box-sizing: border-box; }
#addr:focus { outline: none; border-color: var(--primary-dark); box-shadow: 0 0 0 4px rgba(91, 33, 182, 0.15); }
h2,h3 { margin-top:0; font-weight:700; color: var(--text); margin-bottom:1rem; }
h2 { border-bottom:1px solid var(--border); padding-bottom:0.75rem; }
table { width: 100%; border-collapse: collapse; margin-top:1rem; }
th,td { padding:0.75rem 1rem; text-align:left; border-bottom:1px solid var(--border); }
th { font-weight:600; color: var(--text-muted); font-size:0.85rem; text-transform: uppercase; }
tbody tr:hover { background-color:#f3f4f6; cursor:pointer; }
.empty { text-align:center; padding:2.5rem 1rem; color: var(--text-muted); font-size:1.1rem; }
.btn-group { display:flex; flex-wrap:wrap; justify-content:center; gap:1rem; margin-top:2rem; }
button { padding:0.8rem 1.8rem; border:none; border-radius:50px; cursor:pointer; font-size:1rem; font-weight:600; color:#fff; transition:all 0.3s ease; background-size:200% auto; box-shadow: var(--shadow); }
button:hover { transform: translateY(-3px); box-shadow: var(--shadow-hover); }
button i { margin-right:0.5rem; }
.btn-primary { background-image: linear-gradient(to right, var(--primary-dark), var(--primary)); }
.btn-secondary { background-image: linear-gradient(to right, #3b82f6, #60a5fa); }
.btn-warning { background-image: linear-gradient(to right, var(--primary-dark), #8b5cf6); color:#fff; }
.btn-contact { background-image: linear-gradient(to right, #7c3aed, #9d4edd); padding:1rem 2rem; font-size:1.1rem; width:100%; max-width:400px; }
.contact-section { text-align:center; }
.copy-toast { position:fixed; bottom:2rem; left:50%; transform:translateX(-50%); background-color: var(--primary); color:#fff; padding:1rem 1.5rem; border-radius:0.5rem; font-weight:500; box-shadow:var(--shadow-hover); display:none; z-index:9999; animation: fadeIn 0.3s forwards, fadeOut 0.3s 2.5s forwards; }
.message-view { padding-bottom:1.5rem; }
.message-header { background-color:#f9fafb; border:1px solid var(--border); padding:1rem; border-radius:0.5rem; margin-bottom:1rem; }
.message-header strong { color:var(--text-muted); }
.message-body { padding:1rem; line-height:1.7; word-break:break-word; white-space:pre-wrap; max-height:400px; overflow-y:auto; background-color:var(--bg); border-radius:0.5rem; border:1px solid var(--border); color:var(--text); }
.message-body a { color: #5b21b6; text-decoration: underline; }
@keyframes fadeIn { from { opacity:0; transform:translate(-50%,20px);} to { opacity:1; transform:translate(-50%,0);} }
@keyframes fadeOut { from { opacity:1; transform:translate(-50%,0);} to { opacity:0; transform:translate(-50%,20px);} }
.logo-footer { text-align:center; padding:2.5rem 1rem 1rem 1rem; }
.logo-footer .logo { height:60px; }
.logo-footer .logo-title { margin:1rem 0 0.5rem; font-size:0.9rem; color: var(--text-muted); }
.logo-footer a { color:var(--primary-dark); font-weight:600; text-decoration:none; }
.loader-container { display:none; flex-direction:column; align-items:center; justify-content:center; padding:1rem 0; }
.loader { border:4px solid #e5e7eb; border-top:4px solid var(--primary); border-radius:50%; width:40px; height:40px; animation:spin 1s linear infinite; }
@keyframes spin { 0% { transform:rotate(0deg);} 100% { transform:rotate(360deg);} }
.loading-text { margin-top:1rem; font-size:1rem; color:var(--text-muted); }
@media (max-width:768px){ header{font-size:2rem;} .container{margin-top:-1.5rem;} .card{padding:1.5rem;} .btn-group{flex-direction:column; gap:0.75rem;} button{width:100%;} }
</style>
</head>
<body>
<header>FTX TempMail Pro</header>
<div class="container">
<div class="card email-box">
<h3 style="text-align:center;">Your Temporary Email Address</h3>
<div class="email-display-wrapper">
<input type="text" id="addr" readonly value="Click 'Generate New' to start">
</div>
<div class="loader-container" id="loadingAnimation">
<div class="loader"></div>
<div class="loading-text">Generating new address...</div>
</div>
<div class="btn-group">
<button class="btn-primary" onclick="genEmail()"><i class="fas fa-plus"></i> Generate New</button>
<button class="btn-secondary" onclick="copyAddr()"><i class="fas fa-copy"></i> Copy</button>
<button class="btn-warning" onclick="refreshMail()"><i class="fas fa-sync-alt"></i> Refresh</button>
</div>
</div>
<div class="card inbox">
<h2><i class="fas fa-inbox"></i> Inbox</h2>
<div id="emptyBox" class="empty">Your inbox is empty.</div>
<table id="emails" style="display:none;">
<thead>
<tr>
<th>From</th>
<th>Subject</th>
<th>Date</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>
<div class="card message-view" id="messageView" style="display:none;">
<h2><i class="fas fa-envelope-open-text"></i> Message Content</h2>
<div class="message-header">
<div><strong>From:</strong> <span id="messageFrom"></span></div>
<div><strong>Subject:</strong> <span id="messageSubject"></span></div>
<div><strong>Date:</strong> <span id="messageDate"></span></div>
</div>
<div class="message-body" id="messageBody"></div>
</div>
<div class="contact-section">
<a href="https://wa.me/923217614902" target="_blank">
<button class="btn-contact"><i class="fab fa-whatsapp"></i> Contact Developer</button></a>
</div>
</div>
<div id="copyToast" class="copy-toast"><i class="fas fa-check-circle"></i> Copied to clipboard!</div>
<div class="logo-footer">
<img src="/FTX_OFFICIAL.PNG" alt="FTX HACKS Logo" class="logo">
<div class="logo-details"><h5 class="logo-title">Discover, and master tech with FTX OFFICIAL.</h5>
<a href="/temp-mail">Â© FTX OFFICIAL</a></div>
</div>

<script>
const WORKER_URL = "https://temp-mail.ftxofficial.workers.dev";
let token, account, messages;

function formatDate(dateObj){
  if(!dateObj) return "Unknown";
  let d = new Date(dateObj);
  if(isNaN(d.getTime())) return "Unknown";
  let day = String(d.getDate()).padStart(2,'0');
  let month = String(d.getMonth()+1).padStart(2,'0');
  let year = d.getFullYear();
  let hours = String(d.getHours()).padStart(2,'0');
  let minutes = String(d.getMinutes()).padStart(2,'0');
  let seconds = String(d.getSeconds()).padStart(2,'0');
  return `${day}/${month}/${year}, ${hours}:${minutes}:${seconds}`;
}

async function genEmail(){
  document.getElementById("loadingAnimation").style.display="flex";
  document.getElementById("addr").value="Generating...";
  try{
    const res = await fetch(WORKER_URL+'/gen',{method:'POST'});
    const data = await res.json();
    token = data.token; account = data.address;
    document.getElementById("addr").value=account;
    document.getElementById("loadingAnimation").style.display="none";
    refreshMail();
  }catch(e){ document.getElementById("addr").value="Failed!"; document.getElementById("loadingAnimation").style.display="none"; console.error(e);}
}

async function refreshMail(){
  if(!token) return;
  try{
    const res = await fetch(WORKER_URL+'/inbox?token='+token);
    messages = await res.json();
    const table=document.getElementById("emails"); const tbody=table.querySelector("tbody"); tbody.innerHTML="";
    if(!messages || messages.length===0){ table.style.display="none"; document.getElementById("emptyBox").style.display="block"; return;}
    document.getElementById("emptyBox").style.display="none"; table.style.display="table";

    for(const msg of messages){
      let row=document.createElement("tr");
      row.innerHTML=`<td>Loading...</td><td>${msg.subject||"No Subject"}</td><td>Loading...</td>`;
      row.onclick=async ()=>{ 
        const res=await fetch(WORKER_URL+'/message?id='+msg.id+'&token='+token);
        const fullMsg=await res.json();
        let sender=typeof fullMsg.from==="string"?fullMsg.from:(fullMsg.from?.email||fullMsg.from?.address||"Unknown");
        let formattedDate=formatDate(fullMsg.date);
        row.children[0].innerText=sender;
        row.children[2].innerText=formattedDate;
        document.getElementById("messageFrom").innerText=sender;
        document.getElementById("messageSubject").innerText=fullMsg.subject||"No Subject";
        document.getElementById("messageDate").innerText=formattedDate;
        document.getElementById("messageBody").innerHTML = linkify(fullMsg.body || "");
        document.getElementById("messageView").style.display="block";
      };
      tbody.appendChild(row);
    }
  }catch(e){ console.error(e); document.getElementById("emptyBox").innerText="Failed to load inbox."; document.getElementById("emptyBox").style.display="block";}
}

async function copyAddr() {
    try {
        const input = document.getElementById("addr");
        input.select();
        input.setSelectionRange(0, 99999); /* mobile devices */
        await navigator.clipboard.writeText(input.value);
        const toast = document.getElementById("copyToast");
        toast.style.display = "block";
        setTimeout(() => { toast.style.display = "none"; }, 3000);
    } catch (err) {
        alert("Failed to copy: " + err);
    }
}

function linkify(text) {
    if(!text) return "";
    const urlPattern = /(https?:\/\/[^\s]+)/g;
    return text.replace(urlPattern, '<a href="$1" target="_blank">$1</a>');
}
</script>
</body>
</html>
